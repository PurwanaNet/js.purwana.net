<!doctype html>
<html lang="id" data-theme-enabled="1">
 <head> 
  <script>window.currentUser = null;</script> 
  <script>window.shopCurrency = "EUR";</script> 
  <script>window.localCurrency = "EUR";</script> 
  <script>window.countryCode = "id";</script> 
  <script>window.rateShopTo = {"EUR":1,"USD":1.0716494077529548,"AMD":417.60490643964846};</script> 
  <title itemprop="name">Server Sent Events</title> 
  <link href="pack/styles.a7ab594e74e7a233e3dd.css" rel="stylesheet"> 
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes, minimum-scale=1.0"> 
  <meta name="apple-mobile-web-app-capable" content="yes"> 
  <!-- chrome autotranslate is enabled only for "en" main version--> 
  <meta name="google" content="notranslate"> 
  <script>if (window.devicePixelRatio > 1) document.cookie = 'pixelRatio=' + window.devicePixelRatio + ';path=/;expires=Tue, 19 Jan 2038 03:14:07 GMT';</script> 
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:bold,italic,bolditalic" rel="stylesheet"> 
  <link rel="apple-touch-icon-precomposed" href="img/favicon/apple-touch-icon-precomposed.png"> 
  <link rel="canonical" href="server-sent-events.html"> 
  <meta name="msapplication-TileColor" content="#222A2C"> 
  <meta name="msapplication-TileImage" content="/img/favicon/tileicon.png"> 
  <link rel="icon" href="img/favicon/favicon.png"> 
  <meta itemprop="image" content="https://id.javascript.info/img/site_preview_en_512x512.png"> 
  <meta property="og:title" content="Server Sent Events"> 
  <meta property="og:image" content="https://id.javascript.info/img/site_preview_en_1200x630.png"> 
  <meta property="og:image:type" content="image/png"> 
  <meta property="og:image:width" content="1200"> 
  <meta property="og:image:height" content="630"> 
  <meta property="fb:admins" content="100001562528165"> 
  <meta name="twitter:card" content="summary"> 
  <meta name="twitter:title" content="Server Sent Events"> 
  <meta name="twitter:site" content="@iliakan"> 
  <meta name="twitter:creator" content="@iliakan"> 
  <meta name="twitter:image" content="https://id.javascript.info/img/site_preview_en_512x512.png"> 
  <link rel="prev" href="websocket.html"> 
  <link rel="next" href="data-storage.html"> 
  <script>window.GA_ID = "UA-2056213-15";</script> 
  <script>window.YANDEX_METRIKA_ID = 32184394;</script> 
  <script>window.RECAPTCHA_ID = "6LfmLAEVAAAAAJMykMnf7aY8nkyTRmYi2ynx51R1";</script> 
  <script src="pack/init.4910a4963629a5955eb6.js"></script> 
  <script src="pack/head.ff7d075915f5367566f2.js" defer></script> 
  <meta property="og:title" content="Server Sent Events"> 
  <meta property="og:type" content="article"> 
  <script src="pack/tutorial.f0717d796f690e0a6aaf.js" defer></script> 
  <script src="pack/footer.5b1695b27f7207cacf2f.js" defer></script> 
   
   
 </head> 
 <body class="no-icons"> 
  <script>window.fontTest();</script> 
  <div class="page-wrapper page-wrapper_sidebar_on"> 
   <!--[if IE]><div style="color:red;text-align:center">Maaf, Internet Explorer tidak didukung, harap gunakan browser yang lebih baru.</div><![endif]--> 
   <div class="sitetoolbar sitetoolbar_tutorial"> 
    <script>window.langs = [{"code":"ar","name":"Arabic"},{"code":"az","name":"Azerbaijani"},{"code":"bg","name":"Bulgarian"},{"code":"bn","name":"Bengali"},{"code":"bs","name":"Bosnian"},{"code":"ca","name":"Catalan"},{"code":"cs","name":"Czech"},{"code":"da","name":"Danish"},{"code":"de","name":"German"},{"code":"el","name":"Greek"},{"code":"en","name":"English"},{"code":"es","name":"Spanish"},{"code":"fa","name":"Persian (Farsi)"},{"code":"fi","name":"Finnish"},{"code":"fr","name":"French"},{"code":"he","name":"Hebrew"},{"code":"hi","name":"Hindi"},{"code":"hr","name":"Croatian"},{"code":"hu","name":"Hungarian"},{"code":"hy","name":"Armenian"},{"code":"id","name":"Indonesian"},{"code":"it","name":"Italian"},{"code":"ja","name":"Japanese"},{"code":"ka","name":"Georgian"},{"code":"kk","name":"Kazakh"},{"code":"km","name":"Central Khmer"},{"code":"ko","name":"Korean"},{"code":"ky","name":"Kyrgyz"},{"code":"lt","name":"Lithuanian"},{"code":"me","name":"Montenegrin"},{"code":"ml","name":"Malayalam"},{"code":"ms","name":"Malay"},{"code":"my","name":"Burmese"},{"code":"nl","name":"Dutch"},{"code":"no","name":"Norvegian"},{"code":"pa","name":"Punjabi"},{"code":"pl","name":"Polish"},{"code":"pt","name":"Portuguese"},{"code":"ro","name":"Romanian"},{"code":"ru","name":"Russian"},{"code":"si","name":"Sinhala"},{"code":"sk","name":"Slovak"},{"code":"sl","name":"Slovenian"},{"code":"sq","name":"Albanian"},{"code":"sr","name":"Serbian"},{"code":"ta","name":"Tamil"},{"code":"te","name":"Telugu"},{"code":"test","name":"Test"},{"code":"th","name":"Thai"},{"code":"tk","name":"Turkmen"},{"code":"tr","name":"Turkish"},{"code":"uk","name":"Ukrainian"},{"code":"ur","name":"Urdu"},{"code":"uz","name":"Uzbek"},{"code":"v2","name":"v2"},{"code":"vi","name":"Vietnamese"},{"code":"zh-hant","name":"Chinese Traditional"},{"code":"zh","name":"Chinese"}];</script> 
    <script>window.lang = "id";</script> 
    <div class="sitetoolbar__content"> 
     <div class="sitetoolbar__logo-wrap"> 
      <br> 
      <a class="sitetoolbar__link sitetoolbar__link_logo" href="index.html"><h1>Teman Javascript</h1></a> 
     </div> 
     <div class="sitetoolbar__nav-toggle-wrap"> 
      <button class="sitetoolbar__nav-toggle" type="button"></button> 
     </div> 
     <nav class="sitetoolbar__sections"> 
      <ul class="sitetoolbar__sections-list"></ul> 
     </nav> 
     <div class="sitetoolbar__theme-switcher"> 
      <div class="theme-changer"> 
       <label class="theme-changer__label" for="theme-changer-input" data-tooltip="Change theme"><input class="theme-changer__input" type="checkbox" id="theme-changer-input" data-theme-changer="data-theme-changer"><span class="theme-changer__icon theme-changer__icon_light-theme"></span><span class="theme-changer__icon theme-changer__icon_dark-theme"></span></label> 
      </div> 
     </div> 
    </div> 
    <div class="tablet-menu"> 
     <div class="tablet-menu__line"> 
      <div class="tablet-menu__content"> 
      </div> 
     </div> 
     <div class="tablet-menu__line"> 
      <div class="tablet-menu__content"> 
      </div> 
     </div> 
     <div class="tablet-menu__line"> 
      <div class="tablet-menu__content"> 
       <div class="theme-changer theme-changer_tablet-menu theme-changer_has-label"> 
        <label class="theme-changer__label" for="theme-changer-input-tablet" data-tooltip="Change theme"><input class="theme-changer__input" type="checkbox" id="theme-changer-input-tablet" data-theme-changer="data-theme-changer"><span class="theme-changer__icon theme-changer__icon_light-theme"></span><span class="theme-changer__icon theme-changer__icon_dark-theme"></span><span class="theme-changer__label-text theme-changer__label-text_light-theme">Light theme</span><span class="theme-changer__label-text theme-changer__label-text_dark-theme">Dark theme</span></label> 
       </div> 
      </div> 
     </div> 
     <div class="tablet-menu__line"> 
      <div class="tablet-menu__content"> 
       <div class="share-icons"> 
        <span class="share-icons__title">Bagikan</span> 
        <a class="share share_tw" href="https://twitter.com/share?url=https%3A%2F%2Fjs.purwana.net%2Fserver-sent-events" rel="nofollow"></a> 
        <a class="share share_fb" href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Fjs.purwana.net%2Fserver-sent-events" rel="nofollow"></a> 
       </div> 
      </div> 
     </div> 
     <div class="tablet-menu__line"> 
      <div class="tablet-menu__content"> 
      </div> 
     </div> 
    </div> 
    <progress class="tutorial-progress" data-sticky value="12" max="12" data-tooltip="Pelajaran 12 dari 12"></progress> 
   </div> 
   <div class="page page_sidebar_on page_inner_padding"> 
    <script>if(localStorage.noSidebar){document.querySelector(".page").classList.remove("page_sidebar_on");let e=document.querySelector(".page-wrapper");e&&e.classList.remove("page-wrapper_sidebar_on")}setTimeout(function(){document.querySelector(".page").classList.add("page_sidebar-animation-on")});</script> 
    <div class="page__inner"> 
     <main class="main main_width-limit"> 
      <header class="main__header"> 
       <div class="main__header-inner"> 
        <div class="main__header-group"> 
         <ol class="breadcrumbs"> 
          <li class="breadcrumbs__item breadcrumbs__item_home"><a class="breadcrumbs__link" href="index.html"><span class="breadcrumbs__hidden-text">Tutorial</span></a></li> 
          <li class="breadcrumbs__item" id="breadcrumb-1"><a class="breadcrumbs__link" href="network.html"><span>Network requests</span></a></li> 
          <script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Tutorial","item":"https://id.javascript.info/"},{"@type":"ListItem","position":2,"name":"Network requests","item":"https://id.javascript.info/network"}]}</script> 
         </ol> 
         <div class="updated-at" data-tooltip="Terakhir diperbarui pada 30 November 2020"> 
          <div class="updated-at__content">
            30 November 2020 
          </div> 
         </div> 
        </div> 
        <div class="notification notification_message notification_warning notification_article"> 
         <div class="notification__content">
           Materi ini hanya tersedia dalam bahasa berikut: 
          <a href="https://javascript.info/server-sent-events">English</a>, 
          <a href="https://es.javascript.info/server-sent-events">Espa??ol</a>, 
          <a href="https://fr.javascript.info/server-sent-events">Fran??ais</a>, 
          <a href="https://it.javascript.info/server-sent-events">Italiano</a>, 
          <a href="https://ja.javascript.info/server-sent-events">?????????</a>, 
          <a href="https://learn.javascript.ru/server-sent-events">??????????????</a>, 
          <a href="https://tr.javascript.info/server-sent-events">T??rk??e</a>, 
          <a href="https://uk.javascript.info/server-sent-events">????????????????????</a>, 
          <a href="https://zh.javascript.info/server-sent-events">????????????</a>. Tolong, menerjemahkan ke dalam 
          <strong>Indonesia</strong>. 
         </div> 
        </div> 
        <h1 class="main__header-title">Server Sent Events</h1> 
       </div> 
      </header> 
      <style>
.gsc-control {
    width: 100%;
}
</style> 
      <script async src="https://cse.google.com/cse.js?cx=670735444dc5843cf"></script> 
      <div class="gcse-search"></div> 
      <div class="content"> 
       <article class="formatted" itemscope itemtype="http://schema.org/TechArticle"> 
        <meta itemprop="name" content="Server Sent Events"> 
        <div itemprop="author" itemscope itemtype="http://schema.org/Person"> 
         <meta itemprop="email" content="iliakan@gmail.com"> 
         <meta itemprop="name" content="Ilya Kantor"> 
        </div> 
        <div itemprop="articleBody"> 
         <p>The <a href="https://html.spec.whatwg.org/multipage/comms.html#the-eventsource-interface">Server-Sent Events</a> specification describes a built-in class <code>EventSource</code>, that keeps connection with the server and allows to receive events from it.</p> 
         <p>Similar to <code>WebSocket</code>, the connection is persistent.</p> 
         <p>But there are several important differences:</p> 
         <table> 
          <thead> 
           <tr> 
            <th><code>WebSocket</code></th> 
            <th><code>EventSource</code></th> 
           </tr> 
          </thead> 
          <tbody> 
           <tr> 
            <td>Bi-directional: both client and server can exchange messages</td> 
            <td>One-directional: only server sends data</td> 
           </tr> 
           <tr> 
            <td>Binary and text data</td> 
            <td>Only text</td> 
           </tr> 
           <tr> 
            <td>WebSocket protocol</td> 
            <td>Regular HTTP</td> 
           </tr> 
          </tbody> 
         </table> 
         <p><code>EventSource</code> is a less-powerful way of communicating with the server than <code>WebSocket</code>.</p> 
         <p>Why should one ever use it?</p> 
         <p>The main reason: it???s simpler. In many applications, the power of <code>WebSocket</code> is a little bit too much.</p> 
         <p>We need to receive a stream of data from server: maybe chat messages or market prices, or whatever. That???s what <code>EventSource</code> is good at. Also it supports auto-reconnect, something we need to implement manually with <code>WebSocket</code>. Besides, it???s a plain old HTTP, not a new protocol.</p> 
         <h2><a class="main__anchor" name="getting-messages" href="server-sent-events.html#getting-messages">Getting messages</a></h2> 
         <p>To start receiving messages, we just need to create <code>new EventSource(url)</code>.</p> 
         <p>The browser will connect to <code>url</code> and keep the connection open, waiting for events.</p> 
         <p>The server should respond with status 200 and the header <code>Content-Type: text/event-stream</code>, then keep the connection and write messages into it in the special format, like this:</p> 
         <div id="616k6mmu74" data-trusted="1" class="code-example"> 
          <div class="codebox code-example__codebox"> 
           <div class="codebox__code" data-code="1"> 
            <pre class="line-numbers language-none"><code>data: Message 1

data: Message 2

data: Message 3
data: of two lines</code></pre> 
           </div> 
          </div> 
         </div> 
         <ul> 
          <li>A message text goes after <code>data:</code>, the space after the colon is optional.</li> 
          <li>Messages are delimited with double line breaks <code>\n\n</code>.</li> 
          <li>To send a line break <code>\n</code>, we can immediately send one more <code>data:</code> (3rd message above).</li> 
         </ul> 
         <p>In practice, complex messages are usually sent JSON-encoded. Line-breaks are encoded as <code>\n</code> within them, so multiline <code>data:</code> messages are not necessary.</p> 
         <p>For instance:</p> 
         <div id="32ppxga6d3" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:0,&quot;cols&quot;:[{&quot;start&quot;:42,&quot;end&quot;:44}]}]"> 
          <div class="codebox code-example__codebox"> 
           <div class="codebox__code" data-code="1"> 
            <pre class="line-numbers language-javascript"><code>data: {"user":"John","message":"First line\n Second line"}</code></pre> 
           </div> 
          </div> 
         </div> 
         <p>???So we can assume that one <code>data:</code> holds exactly one message.</p> 
         <p>For each such message, the <code>message</code> event is generated:</p> 
         <div id="tsfoe7a7oo" data-trusted="1" class="code-example"> 
          <div class="codebox code-example__codebox"> 
           <div class="codebox__code" data-code="1"> 
            <pre class="line-numbers language-javascript"><code>let eventSource = new EventSource("/events/subscribe");

eventSource.onmessage = function(event) {
  console.log("New message", event.data);
  // will log 3 times for the data stream above
};

// or eventSource.addEventListener('message', ...)</code></pre> 
           </div> 
          </div> 
         </div> 
         <h3><a class="main__anchor" name="cross-origin-requests" href="server-sent-events.html#cross-origin-requests">Cross-origin requests</a></h3> 
         <p><code>EventSource</code> supports cross-origin requests, like <code>fetch</code> and any other networking methods. We can use any URL:</p> 
         <div id="sluc5sej0f" data-trusted="1" class="code-example"> 
          <div class="codebox code-example__codebox"> 
           <div class="codebox__code" data-code="1"> 
            <pre class="line-numbers language-javascript"><code>let source = new EventSource("https://another-site.com/events");</code></pre> 
           </div> 
          </div> 
         </div> 
         <p>The remote server will get the <code>Origin</code> header and must respond with <code>Access-Control-Allow-Origin</code> to proceed.</p> 
         <p>To pass credentials, we should set the additional option <code>withCredentials</code>, like this:</p> 
         <div id="bhx1w5ovig" data-trusted="1" class="code-example"> 
          <div class="codebox code-example__codebox"> 
           <div class="codebox__code" data-code="1"> 
            <pre class="line-numbers language-javascript"><code>let source = new EventSource("https://another-site.com/events", {
  withCredentials: true
});</code></pre> 
           </div> 
          </div> 
         </div> 
         <p>Please see the chapter <a href="fetch-crossorigin.html">Fetch: *request Cross-Origin*</a> for more details about cross-origin headers.</p> 
         <h2><a class="main__anchor" name="reconnection" href="server-sent-events.html#reconnection">Reconnection</a></h2> 
         <p>Upon creation, <code>new EventSource</code> connects to the server, and if the connection is broken ??? reconnects.</p> 
         <p>That???s very convenient, as we don???t have to care about it.</p> 
         <p>There???s a small delay between reconnections, a few seconds by default.</p> 
         <p>The server can set the recommended delay using <code>retry:</code> in response (in milliseconds):</p> 
         <div id="0ku4dqk2yu" data-trusted="1" class="code-example"> 
          <div class="codebox code-example__codebox"> 
           <div class="codebox__code" data-code="1"> 
            <pre class="line-numbers language-javascript"><code>retry: 15000
data: Hello, I set the reconnection delay to 15 seconds</code></pre> 
           </div> 
          </div> 
         </div> 
         <p>The <code>retry:</code> may come both together with some data, or as a standalone message.</p> 
         <p>The browser should wait that many milliseconds before reconnecting. Or longer, e.g. if the browser knows (from OS) that there???s no network connection at the moment, it may wait until the connection appears, and then retry.</p> 
         <ul> 
          <li>If the server wants the browser to stop reconnecting, it should respond with HTTP status 204.</li> 
          <li>If the browser wants to close the connection, it should call <code>eventSource.close()</code>:</li> 
         </ul> 
         <div id="j0ldnkygrl" data-trusted="1" class="code-example"> 
          <div class="codebox code-example__codebox"> 
           <div class="codebox__code" data-code="1"> 
            <pre class="line-numbers language-javascript"><code>let eventSource = new EventSource(...);

eventSource.close();</code></pre> 
           </div> 
          </div> 
         </div> 
         <p>Also, there will be no reconnection if the response has an incorrect <code>Content-Type</code> or its HTTP status differs from 301, 307, 200 and 204. In such cases the <code>"error"</code> event will be emitted, and the browser won???t reconnect.</p> 
         <div class="important important_smart"> 
          <div class="important__header"> 
           <span class="important__type">Tolong dicatat:</span> 
          </div> 
          <div class="important__content"> 
           <p>When a connection is finally closed, there???s no way to ???reopen??? it. If we???d like to connect again, just create a new <code>EventSource</code>.</p> 
          </div> 
         </div> 
         <h2><a class="main__anchor" name="message-id" href="server-sent-events.html#message-id">Message id</a></h2> 
         <p>When a connection breaks due to network problems, either side can???t be sure which messages were received, and which weren???t.</p> 
         <p>To correctly resume the connection, each message should have an <code>id</code> field, like this:</p> 
         <div id="t917ppoq2n" data-trusted="1" class="code-example"> 
          <div class="codebox code-example__codebox"> 
           <div class="codebox__code" data-code="1"> 
            <pre class="line-numbers language-none"><code>data: Message 1
id: 1

data: Message 2
id: 2

data: Message 3
data: of two lines
id: 3</code></pre> 
           </div> 
          </div> 
         </div> 
         <p>When a message with <code>id:</code> is received, the browser:</p> 
         <ul> 
          <li>Sets the property <code>eventSource.lastEventId</code> to its value.</li> 
          <li>Upon reconnection sends the header <code>Last-Event-ID</code> with that <code>id</code>, so that the server may re-send following messages.</li> 
         </ul> 
         <div class="important important_smart"> 
          <div class="important__header"> 
           <span class="important__type">Put <code>id:</code> after <code>data:</code></span> 
          </div> 
          <div class="important__content"> 
           <p>Please note: the <code>id</code> is appended below message <code>data</code> by the server, to ensure that <code>lastEventId</code> is updated after the message is received.</p> 
          </div> 
         </div> 
         <h2><a class="main__anchor" name="connection-status-readystate" href="server-sent-events.html#connection-status-readystate">Connection status: readyState</a></h2> 
         <p>The <code>EventSource</code> object has <code>readyState</code> property, that has one of three values:</p> 
         <div id="p55mveygq8" data-trusted="1" class="code-example"> 
          <div class="codebox code-example__codebox"> 
           <div class="codebox__code" data-code="1"> 
            <pre class="line-numbers language-javascript"><code>EventSource.CONNECTING = 0; // connecting or reconnecting
EventSource.OPEN = 1;       // connected
EventSource.CLOSED = 2;     // connection closed</code></pre> 
           </div> 
          </div> 
         </div> 
         <p>When an object is created, or the connection is down, it???s always <code>EventSource.CONNECTING</code> (equals <code>0</code>).</p> 
         <p>We can query this property to know the state of <code>EventSource</code>.</p> 
         <h2><a class="main__anchor" name="event-types" href="server-sent-events.html#event-types">Event types</a></h2> 
         <p>By default <code>EventSource</code> object generates three events:</p> 
         <ul> 
          <li><code>message</code> ??? a message received, available as <code>event.data</code>.</li> 
          <li><code>open</code> ??? the connection is open.</li> 
          <li><code>error</code> ??? the connection could not be established, e.g. the server returned HTTP 500 status.</li> 
         </ul> 
         <p>The server may specify another type of event with <code>event: ...</code> at the event start.</p> 
         <p>For example:</p> 
         <div id="d0l4sn4i8c" data-trusted="1" class="code-example"> 
          <div class="codebox code-example__codebox"> 
           <div class="codebox__code" data-code="1"> 
            <pre class="line-numbers language-none"><code>event: join
data: Bob

data: Hello

event: leave
data: Bob</code></pre> 
           </div> 
          </div> 
         </div> 
         <p>To handle custom events, we must use <code>addEventListener</code>, not <code>onmessage</code>:</p> 
         <div id="2e1wzh5jlr" data-trusted="1" class="code-example"> 
          <div class="codebox code-example__codebox"> 
           <div class="codebox__code" data-code="1"> 
            <pre class="line-numbers language-javascript"><code>eventSource.addEventListener('join', event =&gt; {
  alert(`Joined ${event.data}`);
});

eventSource.addEventListener('message', event =&gt; {
  alert(`Said: ${event.data}`);
});

eventSource.addEventListener('leave', event =&gt; {
  alert(`Left ${event.data}`);
});</code></pre> 
           </div> 
          </div> 
         </div> 
         <h2><a class="main__anchor" name="full-example" href="server-sent-events.html#full-example">Full example</a></h2> 
         <p>Here???s the server that sends messages with <code>1</code>, <code>2</code>, <code>3</code>, then <code>bye</code> and breaks the connection.</p> 
         <p>Then the browser automatically reconnects.</p> 
         <div class="code-tabs code-tabs_result_on"> 
          <div class="code-tabs__tools"> 
           <div class="code-tabs__scroll-wrap"> 
            <button class="code-tabs__scroll-button code-tabs__scroll-button_left" title="&amp;larr;" data-code-tabs-left="data-code-tabs-left"></button> 
           </div> 
           <div class="code-tabs__switches-wrap"> 
            <div class="code-tabs__switches" data-code-tabs-switches="data-code-tabs-switches"> 
             <div class="code-tabs__switches-items"> 
              <div class="code-tabs__switch code-tabs__switch_current">
                Hasil 
              </div> 
              <div class="code-tabs__switch">
                server.js 
              </div> 
              <div class="code-tabs__switch">
                index.html 
              </div> 
             </div> 
            </div> 
           </div> 
           <div class="code-tabs__scroll-wrap"> 
            <button class="code-tabs__scroll-button code-tabs__scroll-button_right" title="&amp;rarr;" data-code-tabs-right="data-code-tabs-right"></button> 
           </div> 
           <div class="code-tabs__buttons"> 
            <a class="code-tabs__button code-tabs__button_external" target="_blank" title="buka di jendela baru" href="article/server-sent-events/eventsource/index.html"></a> 
            <a class="code-tabs__button code-tabs__button_download" target="_blank" href="tutorial/zipview/eventsource.zip@plunkId=wmV0JJso1lTHrtSr"></a> 
           </div> 
          </div> 
          <div class="code-tabs__content" data-code-tabs-content="data-code-tabs-content" style="height:200px"> 
           <div class="code-tabs__section code-tabs__section_current"> 
            <iframe class="code-tabs__result" src="article/server-sent-events/eventsource/index.html"></iframe> 
           </div> 
           <div class="code-tabs__section"> 
            <pre class="language-javascript line-numbers"><code>let http = require('http');
let url = require('url');
let querystring = require('querystring');
let static = require('node-static');
let fileServer = new static.Server('.');

function onDigits(req, res) {
  res.writeHead(200, {
    'Content-Type': 'text/event-stream; charset=utf-8',
    'Cache-Control': 'no-cache'
  });

  let i = 0;

  let timer = setInterval(write, 1000);
  write();

  function write() {
    i++;

    if (i == 4) {
      res.write('event: bye\ndata: bye-bye\n\n');
      clearInterval(timer);
      res.end();
      return;
    }

    res.write('data: ' + i + '\n\n');

  }
}

function accept(req, res) {

  if (req.url == '/digits') {
    onDigits(req, res);
    return;
  }

  fileServer.serve(req, res);
}


if (!module.parent) {
  http.createServer(accept).listen(8080);
} else {
  exports.accept = accept;
}</code></pre> 
           </div> 
           <div class="code-tabs__section"> 
            <pre class="language-markup line-numbers"><code>&lt;!DOCTYPE html&gt;
&lt;script&gt;
let eventSource;

function start() { // when "Start" button pressed
  if (!window.EventSource) {
    // IE or an old browser
    alert("The browser doesn't support EventSource.");
    return;
  }

  eventSource = new EventSource('digits');

  eventSource.onopen = function(e) {
    log("Event: open");
  };

  eventSource.onerror = function(e) {
    log("Event: error");
    if (this.readyState == EventSource.CONNECTING) {
      log(`Reconnecting (readyState=${this.readyState})...`);
    } else {
      log("Error has occured.");
    }
  };

  eventSource.addEventListener('bye', function(e) {
    log("Event: bye, data: " + e.data);
  });

  eventSource.onmessage = function(e) {
    log("Event: message, data: " + e.data);
  };
}

function stop() { // when "Stop" button pressed
  eventSource.close();
  log("eventSource.close()");
}

function log(msg) {
  logElem.innerHTML += msg + "&lt;br&gt;";
  document.documentElement.scrollTop = 99999999;
}
&lt;/script&gt;

&lt;button onclick="start()"&gt;Start&lt;/button&gt; Press the "Start" to begin.
&lt;div id="logElem" style="margin: 6px 0"&gt;&lt;/div&gt;

&lt;button onclick="stop()"&gt;Stop&lt;/button&gt; "Stop" to finish.</code></pre> 
           </div> 
          </div> 
         </div> 
         <h2><a class="main__anchor" name="summary" href="server-sent-events.html#summary">Summary</a></h2> 
         <p><code>EventSource</code> object automatically establishes a persistent connection and allows the server to send messages over it.</p> 
         <p>It offers:</p> 
         <ul> 
          <li>Automatic reconnect, with tunable <code>retry</code> timeout.</li> 
          <li>Message ids to resume events, the last received identifier is sent in <code>Last-Event-ID</code> header upon reconnection.</li> 
          <li>The current state is in the <code>readyState</code> property.</li> 
         </ul> 
         <p>That makes <code>EventSource</code> a viable alternative to <code>WebSocket</code>, as the latter is more low-level and lacks such built-in features (though they can be implemented).</p> 
         <p>In many real-life applications, the power of <code>EventSource</code> is just enough.</p> 
         <p>Supported in all modern browsers (not IE).</p> 
         <p>The syntax is:</p> 
         <div id="smt1nywm2w" data-trusted="1" class="code-example"> 
          <div class="codebox code-example__codebox"> 
           <div class="codebox__code" data-code="1"> 
            <pre class="line-numbers language-javascript"><code>let source = new EventSource(url, [credentials]);</code></pre> 
           </div> 
          </div> 
         </div> 
         <p>The second argument has only one possible option: <code>{ withCredentials: true }</code>, it allows sending cross-origin credentials.</p> 
         <p>Overall cross-origin security is same as for <code>fetch</code> and other network methods.</p> 
         <h3><a class="main__anchor" name="properties-of-an-eventsource-object" href="server-sent-events.html#properties-of-an-eventsource-object">Properties of an <code>EventSource</code> object</a></h3> 
         <dl> 
          <dt> 
           <code>readyState</code> 
          </dt> 
          <dd>
            The current connection state: either 
           <code>EventSource.CONNECTING (=0)</code>, 
           <code>EventSource.OPEN (=1)</code> or 
           <code>EventSource.CLOSED (=2)</code>. 
          </dd> 
          <dt> 
           <code>lastEventId</code> 
          </dt> 
          <dd>
            The last received 
           <code>id</code>. Upon reconnection the browser sends it in the header 
           <code>Last-Event-ID</code>. 
          </dd> 
         </dl> 
         <h3><a class="main__anchor" name="methods" href="server-sent-events.html#methods">Methods</a></h3> 
         <dl> 
          <dt> 
           <code>close()</code> 
          </dt> 
          <dd>
            Closes the connection. 
          </dd> 
         </dl> 
         <h3><a class="main__anchor" name="events" href="server-sent-events.html#events">Events</a></h3> 
         <dl> 
          <dt> 
           <code>message</code> 
          </dt> 
          <dd>
            Message received, the data is in 
           <code>event.data</code>. 
          </dd> 
          <dt> 
           <code>open</code> 
          </dt> 
          <dd>
            The connection is established. 
          </dd> 
          <dt> 
           <code>error</code> 
          </dt> 
          <dd>
            In case of an error, including both lost connection (will auto-reconnect) and fatal errors. We can check 
           <code>readyState</code> to see if the reconnection is being attempted. 
          </dd> 
         </dl> 
         <p>The server may set a custom event name in <code>event:</code>. Such events should be handled using <code>addEventListener</code>, not <code>on&lt;event&gt;</code>.</p> 
         <h3><a class="main__anchor" name="server-response-format" href="server-sent-events.html#server-response-format">Server response format</a></h3> 
         <p>The server sends messages, delimited by <code>\n\n</code>.</p> 
         <p>A message may have following fields:</p> 
         <ul> 
          <li><code>data:</code> ??? message body, a sequence of multiple <code>data</code> is interpreted as a single message, with <code>\n</code> between the parts.</li> 
          <li><code>id:</code> ??? renews <code>lastEventId</code>, sent in <code>Last-Event-ID</code> on reconnect.</li> 
          <li><code>retry:</code> ??? recommends a retry delay for reconnections in ms. There???s no way to set it from JavaScript.</li> 
          <li><code>event:</code> ??? event name, must precede <code>data:</code>.</li> 
         </ul> 
         <p>A message may include one or more fields in any order, but <code>id:</code> usually goes the last.</p> 
        </div> 
       </article> 
      </div> 
      <div class="page__nav-wrap"> 
       <a class="page__nav page__nav_prev" href="websocket.html" data-tooltip="WebSocket"><span class="page__nav-text"><span class="page__nav-text-shortcut"></span></span><span class="page__nav-text-alternate">Pelajaran sebelumnya</span></a> 
       <a class="page__nav page__nav_next" href="data-storage.html" data-tooltip="Menyimpan data didalam _Browser_"><span class="page__nav-text"><span class="page__nav-text-shortcut"></span></span><span class="page__nav-text-alternate">Pelajaran berikutnya</span></a> 
      </div> 
      <div class="article-tablet-foot tablet-only"> 
       <div class="article-tablet-foot__layout"> 
        <div class="share-icons"> 
         <span class="share-icons__title">Bagikan</span> 
         <a class="share share_tw" href="https://twitter.com/share?url=https%3A%2F%2Fjs.purwana.net%2Fserver-sent-events" rel="nofollow"></a> 
         <a class="share share_fb" href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Fjs.purwana.net%2Fserver-sent-events" rel="nofollow"></a> 
        </div> 
        <div class="article-tablet-foot__map"> 
         <a class="map" href="tutorial/map.html" data-action="tutorial-map"><span class="map__text">Peta tutorial</span></a> 
        </div> 
       </div> 
      </div> 
     </main> 
    </div> 
    <div class="sidebar page__sidebar sidebar sidebar_sticky-footer"> 
     <button class="sidebar__toggle" data-sidebar-toggle></button> 
     <div class="sidebar__inner"> 
      <div class="sidebar__content"> 
       <div class="sidebar__section"> 
        <h4 class="sidebar__section-title">Bab</h4> 
        <nav class="sidebar__navigation"> 
         <ul class="sidebar__navigation-links"> 
          <li class="sidebar__navigation-link"><a class="sidebar__link" href="network.html">Network requests</a></li> 
         </ul> 
        </nav> 
       </div> 
       <div class="sidebar__section"> 
        <h4 class="sidebar__section-title">Navigasi pelajaran</h4> 
        <nav class="sidebar__navigation"> 
         <ul class="sidebar__navigation-links"> 
          <li class="sidebar__navigation-link"><a class="sidebar__link" href="server-sent-events.html#getting-messages">Getting messages</a></li> 
          <li class="sidebar__navigation-link"><a class="sidebar__link" href="server-sent-events.html#reconnection">Reconnection</a></li> 
          <li class="sidebar__navigation-link"><a class="sidebar__link" href="server-sent-events.html#message-id">Message id</a></li> 
          <li class="sidebar__navigation-link"><a class="sidebar__link" href="server-sent-events.html#connection-status-readystate">Connection status: readyState</a></li> 
          <li class="sidebar__navigation-link"><a class="sidebar__link" href="server-sent-events.html#event-types">Event types</a></li> 
          <li class="sidebar__navigation-link"><a class="sidebar__link" href="server-sent-events.html#full-example">Full example</a></li> 
          <li class="sidebar__navigation-link"><a class="sidebar__link" href="server-sent-events.html#summary">Summary</a></li> 
         </ul> 
        </nav> 
       </div> 
       <div class="sidebar__section"> 
        <nav class="sidebar__navigation"> 
         <ul class="sidebar__navigation-links"> 
          <li class="sidebar__navigation-link"><a class="sidebar__link" href="server-sent-events.html#comments">komentar</a></li> 
         </ul> 
        </nav> 
       </div> 
       <div class="sidebar__section"> 
        <div class="sidebar__section-title">
          Bagikan 
        </div> 
        <a class="share share_tw sidebar__share" href="https://twitter.com/share?url=https%3A%2F%2Fjs.purwana.net%2Fserver-sent-events" rel="nofollow"></a> 
        <a class="share share_fb sidebar__share" href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Fjs.purwana.net%2Fserver-sent-events" rel="nofollow"></a> 
       </div> 
       <div class="sidebar__section"></div> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
  <div class="page-footer"> 
   <ul class="page-footer__list"> 
    <li class="page-footer__item page-footer__item_copy">??&nbsp;2007???2023&nbsp; Teman JS</li> 
    <li class="page-footer__item page-footer__item_about"><!--by <a href="https://wifi.purwana.net">klub wifi merdeka</a>--></li> 
    <li class="page-footer__item page-footer__item_contact"><!--built with <a href="https://angga.purwana.net" target="_blank">angga purwana</a>--></li> 
   </ul> 
  </div>  
 </body>
</html>